<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fixer - Dynamic Lighting System Demo</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            overflow: hidden;
        }
        
        #gameCanvas {
            display: block;
            border: 1px solid #333;
        }
        
        .controls {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border: 1px solid #333;
            border-radius: 5px;
        }
        
        .controls h3 {
            margin: 0 0 10px 0;
            color: #00ffff;
        }
        
        .controls button {
            background: #1a1a2e;
            color: #00ff00;
            border: 1px solid #333;
            padding: 5px 10px;
            margin: 2px;
            cursor: pointer;
            font-family: inherit;
        }
        
        .controls button:hover {
            background: #2a2a3e;
            border-color: #00ff00;
        }
        
        .info {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border: 1px solid #333;
            border-radius: 5px;
            max-width: 300px;
        }
        
        .info h3 {
            margin: 0 0 10px 0;
            color: #ff00ff;
        }
        
        .info p {
            margin: 5px 0;
            font-size: 12px;
            line-height: 1.4;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="1200" height="800"></canvas>
    
    <div class="controls">
        <h3>Lighting Controls</h3>
        <div>
            <strong>Weather:</strong><br>
            <button onclick="demo.setWeather('clear')">Clear</button>
            <button onclick="demo.setWeather('rain')">Rain</button>
            <button onclick="demo.setWeather('fog')">Fog</button>
            <button onclick="demo.setWeather('storm')">Storm</button>
        </div>
        <br>
        <div>
            <strong>Time:</strong><br>
            <button onclick="demo.setTimeOfDay(6)">Dawn</button>
            <button onclick="demo.setTimeOfDay(12)">Noon</button>
            <button onclick="demo.setTimeOfDay(18)">Dusk</button>
            <button onclick="demo.setTimeOfDay(22)">Night</button>
        </div>
        <br>
        <div>
            <strong>Effects:</strong><br>
            <button onclick="addRandomExplosion()">Explosion</button>
            <button onclick="addRandomMuzzleFlash()">Muzzle Flash</button>
        </div>
    </div>
    
    <div class="info">
        <h3>Cyberpunk Lighting Demo</h3>
        <p><strong>Features Demonstrated:</strong></p>
        <p>• District-appropriate lighting (Corporate neon, Industrial harsh, Residential warm, Underground dim, Wasteland minimal)</p>
        <p>• Day/night cycle with gameplay effects</p>
        <p>• Weather-based atmospheric effects</p>
        <p>• Dynamic combat lighting (explosions, muzzle flashes)</p>
        <p>• Real-time performance optimization</p>
        <p><strong>Camera:</strong> Auto-panning to show different districts</p>
        <p><strong>Performance:</strong> Check browser console for detailed stats</p>
    </div>

    <script type="module">
        // This would normally import from the built modules
        // For demo purposes, we'll create a simple mock
        
        class Vector2 {
            constructor(x, y) {
                this.x = x;
                this.y = y;
            }
        }
        
        // Mock lighting demo for HTML demonstration
        class MockLightingDemo {
            constructor(canvas) {
                this.canvas = canvas;
                this.ctx = canvas.getContext('2d');
                this.time = 22;
                this.weather = 'clear';
                this.effects = [];
                this.districts = [
                    { name: 'Corporate', x: -200, y: -200, color: '#00ffff' },
                    { name: 'Industrial', x: 0, y: -200, color: '#ffaa00' },
                    { name: 'Residential', x: -200, y: 0, color: '#ffcc66' },
                    { name: 'Underground', x: 0, y: 0, color: '#ff4444' },
                    { name: 'Wasteland', x: 200, y: 200, color: '#444444' }
                ];
                this.cameraX = 0;
                this.cameraY = 0;
                this.start();
            }
            
            start() {
                this.gameLoop();
            }
            
            gameLoop = () => {
                this.update();
                this.render();
                requestAnimationFrame(this.gameLoop);
            };
            
            update() {
                const time = Date.now() * 0.0005;
                this.cameraX = Math.sin(time) * 100;
                this.cameraY = Math.cos(time) * 100;
                
                // Update effects
                this.effects = this.effects.filter(effect => {
                    effect.life -= 16;
                    return effect.life > 0;
                });
            }
            
            render() {
                // Clear canvas with dark background
                this.ctx.fillStyle = this.getAmbientColor();
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Render districts
                this.districts.forEach(district => {
                    this.renderDistrict(district);
                });
                
                // Render effects
                this.effects.forEach(effect => {
                    this.renderEffect(effect);
                });
                
                // Render weather
                this.renderWeather();
                
                // Render stats
                this.renderStats();
            }
            
            getAmbientColor() {
                if (this.time >= 6 && this.time < 18) {
                    return '#2a2a3e'; // Day
                } else {
                    return '#1a1a2e'; // Night
                }
            }
            
            renderDistrict(district) {
                const screenX = this.canvas.width / 2 + (district.x - this.cameraX);
                const screenY = this.canvas.height / 2 + (district.y - this.cameraY);
                
                // Create gradient for district lighting
                const gradient = this.ctx.createRadialGradient(
                    screenX, screenY, 0,
                    screenX, screenY, 150
                );
                
                const intensity = this.time >= 6 && this.time < 18 ? 0.3 : 0.6;
                gradient.addColorStop(0, district.color + Math.floor(intensity * 255).toString(16).padStart(2, '0'));
                gradient.addColorStop(1, district.color + '00');
                
                this.ctx.fillStyle = gradient;
                this.ctx.fillRect(screenX - 100, screenY - 100, 200, 200);
                
                // District label
                this.ctx.fillStyle = district.color;
                this.ctx.font = '12px monospace';
                this.ctx.textAlign = 'center';
                this.ctx.fillText(district.name, screenX, screenY - 80);
            }
            
            renderEffect(effect) {
                const screenX = this.canvas.width / 2 + (effect.x - this.cameraX);
                const screenY = this.canvas.height / 2 + (effect.y - this.cameraY);
                
                const alpha = Math.floor((effect.life / effect.maxLife) * 255).toString(16).padStart(2, '0');
                const gradient = this.ctx.createRadialGradient(
                    screenX, screenY, 0,
                    screenX, screenY, effect.radius
                );
                
                gradient.addColorStop(0, effect.color + alpha);
                gradient.addColorStop(1, effect.color + '00');
                
                this.ctx.fillStyle = gradient;
                this.ctx.beginPath();
                this.ctx.arc(screenX, screenY, effect.radius, 0, Math.PI * 2);
                this.ctx.fill();
            }
            
            renderWeather() {
                if (this.weather === 'rain' || this.weather === 'storm') {
                    this.ctx.strokeStyle = 'rgba(100, 100, 150, 0.5)';
                    this.ctx.lineWidth = 1;
                    
                    for (let i = 0; i < 100; i++) {
                        const x = (i * 37 + Date.now() * 0.2) % this.canvas.width;
                        const y1 = (i * 23 + Date.now() * 0.3) % this.canvas.height;
                        const y2 = y1 + 20;
                        
                        this.ctx.beginPath();
                        this.ctx.moveTo(x, y1);
                        this.ctx.lineTo(x + 5, y2);
                        this.ctx.stroke();
                    }
                }
                
                if (this.weather === 'fog') {
                    this.ctx.fillStyle = 'rgba(60, 60, 80, 0.3)';
                    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                }
            }
            
            renderStats() {
                this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
                this.ctx.fillRect(10, 10, 200, 100);
                
                this.ctx.fillStyle = '#00ff00';
                this.ctx.font = '12px monospace';
                this.ctx.textAlign = 'left';
                
                let y = 25;
                this.ctx.fillText(`Time: ${this.time.toString().padStart(2, '0')}:00`, 15, y);
                y += 15;
                this.ctx.fillText(`Weather: ${this.weather}`, 15, y);
                y += 15;
                this.ctx.fillText(`Districts: ${this.districts.length}`, 15, y);
                y += 15;
                this.ctx.fillText(`Effects: ${this.effects.length}`, 15, y);
                y += 15;
                this.ctx.fillText(`Camera: (${Math.floor(this.cameraX)}, ${Math.floor(this.cameraY)})`, 15, y);
            }
            
            setWeather(weather) {
                this.weather = weather;
                console.log(`Weather changed to: ${weather}`);
            }
            
            setTimeOfDay(hour) {
                this.time = hour;
                console.log(`Time changed to: ${hour}:00`);
            }
            
            addExplosion(x, y) {
                this.effects.push({
                    x: x || (Math.random() - 0.5) * 400,
                    y: y || (Math.random() - 0.5) * 400,
                    color: '#ffaa00',
                    radius: 100,
                    life: 500,
                    maxLife: 500
                });
            }
            
            addMuzzleFlash(x, y) {
                this.effects.push({
                    x: x || (Math.random() - 0.5) * 400,
                    y: y || (Math.random() - 0.5) * 400,
                    color: '#ffffff',
                    radius: 30,
                    life: 100,
                    maxLife: 100
                });
            }
        }
        
        // Initialize demo
        const canvas = document.getElementById('gameCanvas');
        const demo = new MockLightingDemo(canvas);
        
        // Make demo available globally for button controls
        window.demo = demo;
        
        // Helper functions for random effects
        window.addRandomExplosion = () => {
            demo.addExplosion();
        };
        
        window.addRandomMuzzleFlash = () => {
            demo.addMuzzleFlash();
        };
        
        // Log demo info
        console.log('Fixer Dynamic Lighting System Demo');
        console.log('This is a simplified demonstration of the lighting system features.');
        console.log('The actual implementation uses WebGL-optimized rendering and more sophisticated effects.');
    </script>
</body>
</html>